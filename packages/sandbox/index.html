<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Document Sandbox</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        body {
            display: grid;
            grid-template-rows: auto;
        }
    </style>
</head>

<body>

    <textarea id="md" placeholder="Enter your markdown here..." style="display: none;resize: vertical; width: 100%; box-sizing: border-box;">
# Seattle Weather

```css
body {
    background-color: pink;
}
```

```json vega
{
  "description": "This is the central brain of the page",
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "signals": [
    {
      "name": "seattle_weather",
      "update": "data('seattle_weather')"
    },
    {
      "name": "IncludeSun",
      "value": true,
      "bind": { "input": "checkbox", "name": "Include Sun: " }
    },
    {
      "name": "IncludeFog",
      "value": true,
      "bind": { "input": "checkbox", "name": "Include Fog: " }
    },
    {
      "name": "IncludeDrizzle",
      "value": true,
      "bind": { "input": "checkbox", "name": "Include Drizzle: " }
    },
    {
      "name": "IncludeRain",
      "value": true,
      "bind": { "input": "checkbox", "name": "Include Rain: " }
    },
    {
      "name": "IncludeSnow",
      "value": true,
      "bind": { "input": "checkbox", "name": "Include Snow: " }
    },
    {
      "name": "MinWind",
      "value": 0,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 30,
        "step": 1,
        "name": "Min Wind: "
      }
    },
    {
      "name": "MaxWind",
      "value": 30,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 30,
        "step": 1,
        "name": "Max Wind: "
      }
    }
  ],
  "data": [
    {
      "name": "seattle_weather",
      "url": "https://vega.github.io/editor/data/seattle-weather.csv",
      "format": {
        "type": "csv"
      },
      "transform": [
        {
          "type": "filter",
          "expr": "IncludeSun ? true : datum.weather != 'sun'"
        },
        {
          "type": "filter",
          "expr": "IncludeFog ? true : datum.weather != 'fog'"
        },
        {
          "type": "filter",
          "expr": "IncludeDrizzle ? true : datum.weather != 'drizzle'"
        },
        {
          "type": "filter",
          "expr": "IncludeRain ? true : datum.weather != 'rain'"
        },
        {
          "type": "filter",
          "expr": "IncludeSnow ? true : datum.weather != 'snow'"
        },
        {
          "type": "filter",
          "expr": "datum.wind >= MinWind && datum.wind <= MaxWind"
        }
      ]
    }
  ]
}
```

Presets allow you to go pre-chosen values:

```json presets
[
  {
    "name": "Basic Gloom",
    "state": {
      "IncludeSun": false,
      "IncludeFog": true,
      "IncludeDrizzle": true,
      "IncludeRain": false,
      "IncludeSnow": false,
      "MinWind": 0,
      "MaxWind": 5
    }
  },
  {
    "name": "reset",
    "state": {
      "MinWind": 0,
      "MaxWind": 30,
      "IncludeSun": true,
      "IncludeFog": true,
      "IncludeDrizzle": true,
      "IncludeRain": true,
      "IncludeSnow": true
    }
  },
  {
    "name": "sunny and calm",
    "state": {
      "IncludeSun": true,
      "IncludeFog": false,
      "IncludeDrizzle": false,
      "IncludeRain": false,
      "IncludeSnow": false,
      "MinWind": 0,
      "MaxWind": 5
    }
  },
  {
    "name": "stormy weather",
    "state": {
      "IncludeSun": false,
      "IncludeFog": false,
      "IncludeDrizzle": true,
      "IncludeRain": true,
      "IncludeSnow": true,
      "MinWind": 5,
      "MaxWind": 30
    }
  },
  {
    "name": "just snow",
    "state": {
      "IncludeSun": false,
      "IncludeFog": false,
      "IncludeDrizzle": false,
      "IncludeRain": false,
      "IncludeSnow": true,
      "MinWind": 0,
      "MaxWind": 10
    }
  }
]
```

Data table:

```json tabulator
{
  "dataSignalName": "seattle_weather",
  "options": {}
}
```

Here is a stacked bar chart of Seattle weather:
Each bar represents the count of weather types for each month.
The colors distinguish between different weather conditions such as sun, fog, drizzle, rain, and snow.

```json vega-lite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "data": { "name": "seattle_weather" },
  "mark": "bar",
  "encoding": {
    "x": {
      "timeUnit": "month",
      "field": "date",
      "type": "ordinal",
      "title": "Month of the year"
    },
    "y": {
      "aggregate": "count",
      "type": "quantitative"
    },
    "color": {
      "field": "weather",
      "type": "nominal",
      "scale": {
        "domain": ["sun", "fog", "drizzle", "rain", "snow"],
        "range": ["#e7ba52", "#c7c7c7", "#aec7e8", "#1f77b4", "#9467bd"]
      },
      "title": "Weather type"
    }
  }
}
```

And here is a heatmap:

```json vega-lite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "data": { "name": "seattle_weather" },
  "title": "Daily Max Temperatures (C) in Seattle, WA",
  "config": {
    "view": {
      "strokeWidth": 0,
      "step": 13
    },
    "axis": {
      "domain": false
    }
  },
  "mark": "rect",
  "encoding": {
    "x": {
      "field": "date",
      "timeUnit": "date",
      "type": "ordinal",
      "title": "Day",
      "axis": {
        "labelAngle": 0,
        "format": "%e"
      }
    },
    "y": {
      "field": "date",
      "timeUnit": "month",
      "type": "ordinal",
      "title": "Month"
    },
    "color": {
      "field": "temp_max",
      "aggregate": "max",
      "type": "quantitative",
      "legend": {
        "title": null
      }
    }
  }
}
```
</textarea>

    <script type="module">
        import { Sandbox } from '/src/index.ts';
        const textarea = document.getElementById('md');
        const sandbox = new Sandbox(document.body, { markdown: textarea.value });
        window.sandbox = sandbox;
        textarea.addEventListener('input', () => {
            sandbox.send({ markdown: textarea.value });
        });
    </script>

</body>

</html>